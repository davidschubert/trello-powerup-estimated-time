<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8" />
        <title>Estimated Time Power-Up</title>
        <!-- Trello Power-Up Client Library -->
        <script src="https://p.trellocdn.com/power-up.min.js"></script>
    </head>
    <body>
        <script>
            console.log("Power-Up Script gestartet.");

            TrelloPowerUp.initialize({
                // Button in der Kartenansicht
                "card-buttons": function (t, options) {
                    console.log("card-buttons wird aufgerufen.");
                    return [
                        {
                            icon: "https://trello-powerups.hawaii.studio/estimated-time/icon.png",
                            text: "Set Estimated Time",
                            callback: function (t) {
                                console.log(
                                    "Button wurde geklickt. Ã–ffne Popup."
                                );
                                return t.popup({
                                    title: "Estimated Time",
                                    url: "./popup.html", // Relativer Pfad zur popup.html
                                    height: 150,
                                });
                            },
                        },
                    ];
                },
                // Badge in der Kartenansicht
                "card-detail-badges": function (t, options) {
                    console.log("card-detail-badges wird aufgerufen.");
                    return t
                        .get("card", "private", "estimatedTime")
                        .then(function (estimatedTime) {
                            if (!estimatedTime) {
                                console.log("Kein Estimated Time gesetzt.");
                                return [];
                            }
                            console.log(
                                "Estimated Time gefunden: " + estimatedTime
                            );
                            return [
                                {
                                    title: "Estimated Time",
                                    text: estimatedTime + "h",
                                    color: "blue",
                                },
                            ];
                        });
                },
            });
        </script>
    </body>
</html>
